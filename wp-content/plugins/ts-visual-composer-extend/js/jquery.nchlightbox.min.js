!function(t,e){t.fn.mousewheel=function(i){var a,r=t(this),s=["DOMMouseScroll","mousewheel"],n="EventListener",o=function(t){return t=t||window.event,i(t,t.wheelDelta?t.wheelDelta/120:t.detail/3),t.preventDefault(),!1};r.on("mouseover mouseout",function(t){for(var i in s)t.target[t.target["add"+n]!==e?((a="mouseout"==t.type)?"remove":"add")+n:(a?"attach":"detach")+"Event"](s[i],o,!1)})}}(jQuery),function(t,e){"use strict";var i={mode:"continuous",thumbs:$TS_VCSC_Lightbox_Thumbs,thumbsize:$TS_VCSC_Lightbox_Thumbsize,scheme:"dark",theme:"metro",size:"960,540",play:!0,autoplay:!1,share:$TS_VCSC_Lightbox_Share,social:"fb,tw,gp,pin",duration:4e3,keyboard:$TS_VCSC_Lightbox_Keyboard,fullscreen:$TS_VCSC_Lightbox_FullScreen,margin:10,zoom:$TS_VCSC_Lightbox_Zoom,fxspeed:$TS_VCSC_Lightbox_FXSpeed,grid:0,gridspace:4,gridorder:!0,captions:$TS_VCSC_Lightbox_Captions,info:!1,backlight:$TS_VCSC_Lightbox_Backlight,usecolor:$TS_VCSC_Lightbox_UseColor,animation:$TS_VCSC_Lightbox_Animation,cors:!1,hashpath:"nch/",bgclose:$TS_VCSC_Lightbox_BGClose,notouch:$TS_VCSC_Lightbox_NoTouch,nohashes:$TS_VCSC_Lightbox_NoHashes},a={title:!1,type:!1,play:!1,related:!1,rel:!1,src:!1,href:!1,width:0,height:0,color:!1,effect:!1},r={},s={light:!1,current:!1,scrollbar:!0,all:{},phase:!0,css3:window.nchcss3,hash:"",isTouchDevice:!1,ns:t({}),event:{trigger:function(){s.ns.trigger.apply(s.ns,arguments)},on:function(){s.ns.on.apply(s.ns,arguments)},off:function(){s.ns.off.apply(s.ns,arguments)}},canFS:!1},n={},o={open:function(t){t.group.main.fadeIn(300)},close:function(t){var e;t.main.fadeOut(300),d.pause(!1);for(var i in t.set)(e=t.set[i].thumb)&&(e.className="")},slideOut:function(t,a){var r=d.getFX(t.opts.effect,t),n=t.group,o=n.css3,u=n.blocks.preview,l=s.phase?-1:1,c=r(0,0,0,1)!==e,h=function(t){return(c?r(0,0,0,t):t)+s.wsize};r(o,l,!0),u.stop().animate({scrollLeft:h(-l*s.wsize)},{duration:i.fxspeed,complete:function(){n.blocks.media.css("visibility","hidden"),r(o,0),a()}}),t.thumb!==e&&(t.thumb.className="")},slideIn:function(t,a){a=a===e?function(){}:a;var r=d.getFX(t.opts.effect,t),n=t.group,o=n.css3,u=n.blocks.preview,l=s.phase?1:-1,c=r(0,0,0,1)!==e,h=function(t){return(c?r(0,0,0,t):t)+s.wsize};r(o,l),n.blocks.media.css("visibility","visible"),o.el.offsetHeight+1,r(o,0,!0),n.blocks.media.css("visibility","visible"),u.stop().scrollLeft(h(-l*s.wsize)).animate({scrollLeft:h(0)},i.fxspeed,function(){u.scrollLeft(h(0))})}},u={youtube:{is:function(t){var e=t.opts.href.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/);return e?(t.opts.size||(t.opts.size=t.group.opts.size),t.opts.videoid=e[1],!0):!1},create:function(t){if("true"==t.opts.related)var e="rel=1";else var e="rel=0";if("true"==t.opts.play)var i="&autoplay=1";else var i="&autoplay=0";return'<iframe class="nch-lb-iframe nch-video-youtube" src="http://www.youtube.com/embed/'+t.opts.videoid+"?"+e+i+'&wmode=opaque" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowfullscreen></iframe>'},thumb:function(t,e){d.loadThumb.call(t,t.opts.src="//img.youtube.com/vi/"+t.opts.videoid+"/hqdefault.jpg",e)},video:!0},vimeo:{is:function(t){var e=t.opts.href.match(/(http|https):\/\/(?:www.)?(?:(vimeo).com)\/(.*)/);return e?(t.opts.videoid=e[3],t.opts.size||(t.opts.size=t.group.opts.size),!0):!1},create:function(t){return"true"==t.opts.play?'<iframe class="nch-lb-iframe nch-video-vimeo" src="http://player.vimeo.com/video/'+t.opts.videoid+'?autoplay=1" width="500" height="500" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>':'<iframe class="nch-lb-iframe nch-video-vimeo" src="http://player.vimeo.com/video/'+t.opts.videoid+'?autoplay=0" width="500" height="500" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},thumb:function(e,i){t.getJSON("//vimeo.com/api/v2/video/"+e.opts.videoid+".json?callback=?",{format:"json"},function(t){d.loadThumb.call(e,e.opts.src=t[0].thumbnail_large,i)})},video:!0},dailymotion:{is:function(t){var i=t.opts.href.match(/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/);return null!==i?(t.opts.videoid=i[4]!==e?i[4]:i[2],t.opts.size||(t.opts.size=t.group.opts.size),!0):!1},create:function(t){return"true"==t.opts.play?'<iframe class="nch-lb-iframe nch-video-dailymotion" src="http://www.dailymotion.com/embed/video/'+t.opts.videoid+'?autoplay=1" width="500" height="500" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>':'<iframe class="nch-lb-iframe nch-video-dailymotion" src="http://www.dailymotion.com/embed/video/'+t.opts.videoid+'?autoplay=0" width="500" height="500" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},thumb:function(t,e){d.loadThumb.call(t,t.opts.src="//www.dailymotion.com/thumbnail/video/"+t.opts.videoid,e)},video:!0},html:{is:function(t){return t.opts.href=t.opts.href.replace(window.location,""),"#"==t.opts.href.charAt(0)||"."==t.opts.href.charAt(0)},create:function(e){return t(e.opts.href).show().get(0)}},ajax:{is:function(t){return t.opts.href.search(/^https?:\/\//i)<0},create:function(e,i){t.ajax({url:e.opts.href,success:i})}},iframe:{is:function(){return!0},create:function(t){return'<iframe class="nch-lb-iframe" src="'+t.opts.href+'" frameBorder="0"></iframe>'}}},l={init:function(r){var n=arguments,o=t(this);if(0==o.length){if(r===e)return o;r.length===e&&1==n.length?t.extend(i,r):(o=d.setFrom.apply(this,[r.charAt!==e?[r]:r,n[1]||{}]),(n[1]||{}).open===e&&l.open.call(o))}else r=r||{},o.each(function(i,n){var o,u=t(n),l=u.is("img")?u:t("img",u);if(o=t.extend({},a,d.getDataProperties(u,{rel:"rel",title:"title",href:"href"})),l.length>0&&(o.src=l.attr("src")),(u.is("a")||0==l.length)&&(l=u),o.rel)s.all[o.rel]===e&&(s.all[o.rel]=new d.mediaGroup(r,o.rel)),s.all[o.rel].add(l,o);else{var c=new d.mediaGroup(r);c.add(l,o),s.all[c.name]=c}});for(var u in s.all)d.renderGrid(s.all[u]);return o},open:function(a){var r,n=t(this);if(a!==e&&s.all[a]!==e&&(r=s.all[a].set[0]),n.data("nch-lb-media")!==e)r=n.data("nch-lb-media");else if(this.jquery)return l.init.apply(this,arguments),l.open.call(this);r&&(s.event.trigger("open",r.group),s.hash="#"+i.hashpath+r.opts.hash,i.nohashes||(window.location.hash=s.hash)),s.scrollpos=s.w.scrollTop(),s.doc.addClass("nch-lb-noscroll")},next:function(t){if(s.current){var a=s.current,r=a.set.length,n=a.current,o=a.set[n+1==r?0:n+1];s.hash="#"+i.hashpath+o.opts.hash,i.nohashes||(window.location.hash=s.hash),d.pause(t===e),s.phase=!0,s.event.trigger("next",[s.current,o])}},previous:function(){if(s.current){var t=s.current,e=t.set.length,a=t.current,r=t.set[0==a?e-1:a-1];s.hash="#"+i.hashpath+r.opts.hash,i.nohashes||(window.location.hash=s.hash),d.pause(!1),s.phase=!1,s.event.trigger("previous",[s.current,r])}},close:function(){if(s.current){var t=s.current;s.hash="",window.location.hash="",history&&history.pushState&&history.pushState("",document.title,window.location.pathname+window.location.search),t.playing&&l.play(),d.fs.on&&d.fs.toggle(),d.detachMedia(t.set[t.current]),s.event.trigger("close",t),o.close(t),s.current.paused=!1,s.current=t.current=!1,s.doc.removeClass("nch-lb-noscroll"),s.w.scrollTop(s.scrollpos)}},fx:function(i,a){a===e?t.extend(n,i):n[i]=a},access:function(t,i){return t!==e&&(d[t]=i),d},play:function(t){var i=s.current,a=i.opts,r=i.main,n=i.blocks.loading,o=i.playing,u=a.duration;if(a.play)return t===e&&o?o:(r.toggleClass("nch-lb-playing"),r.find(".nch-lb-icon-play").html(o?"p":"s"),o?n.stop():n.animate({width:r.width()},{easing:"linear",duration:(1-n.width()/r.width())*u,complete:function(){i.paused=!0,l.next()}}),t!==!1&&s.event.trigger(o?"stop":"play",i),i.playing=!o)},stop:function(){return s.current.playing&&l.play(!0),!1},info:function(){return s.current?d.toggleInfo.apply({},arguments):void 0},addEvent:function(t,e){s.event.on(t,e)},removeEvent:function(t,e){s.event.off(t,e)},getGroupName:function(){var i,a=t(this),r=!1;return a.length>0?(i=t(a.get(0)).data("nch-lb-media"))!==e?i.group.name:r:r},getMediaId:function(){var i,a=t(this),r=!1;return a.length>0?(i=t(a.get(0)).data("nch-lb-media"))!==e?i.opts.hash:r:r}},c="",d={toggleInfo:function(t){var i=s.current,a=i.blocks,r=a.info.children(".nch-lb-info-panel");return t!==e&&i.about==t?t:(a.info["fade"+(i.about?"Out":"In")](400),r.append(i.info.show()),s.event.trigger((i.about?"close":"open")+"_info",[i]),i.about=!i.about)},selectThumb:function(i){var a,r=i.thumb,s=i.group,n=s.blocks,o=0,u=t(r),l=u.parent(),c=l.prev().find("img").get(0),d=l.next().find("img").get(0);if(r!==e&&s.opts.thumbs){for(var h in s.set)(a=s.set[h].thumb)&&(a.className="");var p,f,m,g=(r.className="nch-lb-thumb-s",s.opts),y={top:1,bottom:1,left:0,right:0}[g.thumbs],v=n.bthumbs,b=(n.thumbs,v[y?"width":"height"]()),j=y?"left":"top",Q="offset"+(y?"Width":"Height"),w={};o=v[f="scroll"+j.substr(0,1).toUpperCase()+j.substr(1)](),m=u.position()[j];var x=m-4,k=m+(p=r[Q])+4;c!==e&&(x-=c[Q]+4),d!==e&&(k+=d[Q]+4),k-x>b?w[f]=m+r[Q]/2-b/2:o>x?w[f]=x:k-b>o&&(w[f]=k-b),v.animate(w,200)}},scrollThumbs:function(t,e){var i,a=s.current,r=a.opts,n=r.thumbs,o={left:"Top",top:"Left",right:"Top",bottom:"Left"};a&&n&&(i=a.blocks.bthumbs,i["scroll"+o[n]](i["scroll"+o[n]]()+120*e))},swipeGesture:function(a){function r(t){return(c=t.gesture)?(h=c.deltaX,((p=Math.abs(h))>25||m)&&(m=!0,f.stop().scrollLeft(Q(-h)),b(v,h/s.wsize)),void 0):!1}function n(){var t=s.current.set.length,e=s.current.current;p>g&&t>1&&("linear"==s.current.opts.mode?!(0==e&&h/p>0||e==t-1&&0>h/p):1)?(o=h>0?0:2*s.wsize,f.animate({scrollLeft:Q(o-s.wsize)},i.fxspeed,function(){l[0>h/p?"next":"previous"](!0)}),b(v,h/p,!0)):(f.stop().animate({scrollLeft:Q(0)},i.fxspeed),b(v,0,!0)),f.off("drag",r).off("dragend",n)}if(a.gesture===e)return!1;if(s.isTouchDevice===e&&(s.isTouchDevice=!(a.gesture.srcEvent.changedTouches===e))&&s.b.addClass("nch-lb-photo-menu-visible"),s.zooming||!s.current||a.gesture===e)return!0;var o,u,c,h,p,f=t(this),m=(t(a.target),a.timeStamp,!1),g=s.wsize/3,y=s.current,v=y.css3,b=d.getFX(y.set[y.current].opts.effect,y.set[y.current]),j=b(0,0,0,1)!==e,Q=function(t){return(j?b(0,0,0,t):t)+s.wsize};return u=a.gesture,f.on("drag",r).on("dragend",n),!1},useTouch:function(t){t.hammer({prevent_default:!0}).on("dragstart",d.swipeGesture)},disableTouch:function(t){t.hammer({prevent_default:!1}).off("dragStart",d.swipeGesture)},pause:function(t){s.current.playing&&!s.current.paused&&((t===!0||"mouseover"==t.type)&&(s.current.paused=!0),l.play(!1))},resume:function(){!s.current.playing&&s.current.paused&&(l.play(!1),s.current.paused=!1)},openShare:function(e){if(s.current){var i,a=s.current,r=a.current,n=a.set[r];"nch-lb-icon-share"==e.target.className?n.share&&"block"==n.share.css("display")?(n.share.hide(),a.main.removeClass("nch-lb-sharing")):(a.main.addClass("nch-lb-sharing"),n.share||(n.share=i=t('<div class="nch-lb-share-btns"></div>').appendTo(t("li.nch-lb-share",a.blocks.menu)),d.shareButtons(i,a.opts.social,d.getMediaProperties(n))),n.share.show()):n.share&&(n.share.hide(),a.main.removeClass("nch-lb-sharing"))}},renderGrid:function(i){var a,r,s,n,o=i.opts,u=i.set,c=!1,h=[];if(o.grid&&!i.hasGrid){i.hasGrid=!0,a=o.grid.split(",");for(var p in a)a[p]=parseInt(a[p]);d.need(i.set,d.getThumbnail,function(){for(var i in u)u[i].thumb!==e&&(r=u[i].main.hide(),c||(c=r),s=t(u[i].thumb).clone(!0).data("nch-lb-media",u[i]).click(l.open).get(0),s.title=u[i].opts.title?u[i].opts.title:"",h.push(s));t('<div class="nch-lb-grid"></div>').insertAfter(c).append(n=t(h)),n.nchgrid({grid:a,margin:o.gridspace,order:o.gridorder,captions:o.captions})})}},parseColor:function(t){for(var e,i=(t+"").split(/bg|\_|\-|\.|\&|\#/),a=0;a<i.length;a++)if((6==(e=i[a].length)||3==e)&&new RegExp("[a-f0-9]{"+e+"}").test(i[a]))return"#"+i[a];return!1},toggleZoom:function(){var e=s.current,i=e.main,a="nch-lb-zooming",r=e.set[e.current];if(r.nsize,i.hasClass(a))s.zooming=!1,d.updateMediaLayout(r),e.blocks.zoom.find(".nch-lb-zoom-container").remove();else{s.zooming=!0;var n,o=new Image;o.onload=function(){n=d.pinch.call(t(o),"100%","100%").css({position:"absolute"}).addClass("nch-lb-zoom-container"),e.blocks.zoom.append(n)},o.src=r.target.src}i.toggleClass(a)},getMediaProperties:function(t){var e=t.opts,i=e.type,a={title:e.title||document.title,media:"html"!=i&&"ajax"!=i?"image"==i||"iframe"==i?t.target.src:e.href:""};return a.url=u[i]&&u[i].video||"iframe"==i?a.media:window.location.href,a},detachMedia:function(e){var i=e.group,a=i.main;t(".nch-lb-title",a).each(function(){t(this).html("")}),t(e.target).detach()},getInnerHeight:function(t,e){t.css({width:e,height:"auto"});var i=t.height();return t.css({height:"auto"}),i},getInnerWidth:function(t,e){t.css({height:e,width:1});var i=t[0].scrollWidth;return t.css({width:"auto"}),i},renderMedia:function(e){function i(i){e.html=i,e.target=t(i)[0],a()}function a(){p.attr("class","nch-lb-media").addClass("nch-lb-media-"+f.type).append(e.target),o.paused&&(l.play(!1),l.play(!1),o.paused=!1),d.updateMediaLayout(e)}var r,n,o=s.current,c=o.main,h=o.blocks,p=h.media,f=e.opts,m=f.type;t(".nch-lb-title",c).each(function(){t(this).html(f.title)}),h.loading.width(0),e.target?a():u[m]&&u[m].video?(e.target=r=t(u[m].create(e)).get(0),n=function(){a(),this.onload&&(this.onload=function(){})},r.attachEvent?r.attachEvent("onload",n):r.onload=n,s.root.append(r)):"iframe"==m?(e.target=r=t(u[m].create(e)).get(0),a()):("html"==m||"ajax"==m)&&("html"==m?i(u[m].create(e)):u[m].create(e,i))},fitInto:function(t,e,i,a){var r,s,n=t/e,o=i/a;return n>o?(r=i>t?t:i,s=r/n):(s=a>e?e:a,r=s*n),[r,s]},updateMediaLayout:function(e){var i,a,r,n,o=!1,l=s.current,c=l.blocks,h=(c.preview,c.media),p=l.mspace.width,f=l.mspace.height,m=e.opts,g=m.type,y={top:0,left:0,width:0,height:0},v=e.nsize;if(s.zooming)return!0;if(u[g]&&u[g].video&&(v=e.nsize=e.group.opts.size.split(",")),n=isNaN(m.width)||isNaN(m.height),"image"==g||u[g]&&u[g].video){var b=v[0]/v[1];0==m.width&&0==m.height?(r=d.fitInto(v[0],v[1],p,f),y.width=r[0],y.height=r[1]):0==m.height?(y.width=p<m.width?p:m.width,y.height=y.width/b>f?(y.width=f*b)/b:y.width/b):0==m.width?(y.height=f<m.height?f:m.height,y.width=y.height*b>p?(y.height=p/b)*b:y.height*b):n||(r=d.fitInto(m.width/1,m.height/1,p,f),y.width=r[0],y.height=r[1])}else"iframe"==g?(0==m.width?y.width=p:n||(y.width=m.width>p?p:m.width),0==m.height?y.height=f:n||(y.height=m.height>f?f:m.height)):("html"==g||"ajax"==g)&&e.target&&(o=!0,m.width>0&&(y.width=m.width>p?p:m.width),m.height>0&&(y.height=m.height>f?f:m.height));if(n&&(m.width/1?y.width=m.width/1:m.height/1&&(y.height=m.height/1),i=isNaN(m.width)?parseFloat(m.width)/100*p:0,a=isNaN(m.height)?parseFloat(m.height)/100*f:0,a&&i?(a||(a=i/v[0]*v[1]),i||(i=a*v[0]/v[1]),r=d.fitInto(i,a,p,f),y.width=r[0],y.height=r[1]):a?i=y.width?y.width:a*v[0]/v[1]:i&&(a=y.height?y.height:i/v[0]*v[1]),r=d.fitInto(i,a,p,f),y.width=r[0],y.height=r[1]),o){y.width||y.height||(y.width=Math.min(p,f));var j=t('<div style="display:block;position:relative;padding:1px"></div>').append(t(e.target).clone()).appendTo(s.root);y.width||(y.width=Math.min(d.getInnerWidth(j,y.height),p)),y.height||(y.height=Math.min(d.getInnerHeight(j,y.width),f)),j.remove()}if(y.top=s.mposy=(f-y.height)/2,y.left=s.wsize+l.mspace.left+(p-y.width)/2,e.group.main[("image"==g&&(v[0]>y.width||v[1]>y.height)&&l.opts.zoom?"add":"remove")+"Class"]("nch-lb-can-zoom"),h.css(y),"iframe"==g||u[g]&&u[g].video){var Q=t("iframe.nch-lb-iframe",h);isNaN(y.height)?Q.height("100%"):Q.height(y.height),isNaN(y.width)?Q.width("100%"):Q.width(y.width)}l.opts.notouch||("html"==g||"ajax"==g?l.hasGestures&&(d.disableTouch(c.preview),l.hasGestures=!1):l.hasGestures||(d.useTouch(c.preview),l.hasGestures=!0))},getMediaColor:function(t,e){var a=t.opts;return i.usecolor?e(i.backlight):a.color?e(a.color):("image"==a.type&&s.hasCanvas?d.getMainColor(t.target,function(t){e("rgb("+t.join(",")+")")}):e(i.backlight),void 0)},enoughThumbs:function(t){for(var e=0,i=0;i<t.set.length;i++)t.set[i].opts.src&&e++;return e>1?!0:(t.opts.thumbs=!1,!1)},toMedia:function(t){function e(){t.group.main&&t.group.blocks.media.css({width:0,height:0}),0==t.group.main&&(d.renderLayout(t.group),d.selectThumb(t)),s.current!==t.group?(s.current&&o.close(s.current.group),s.current=t.group,s.current.current=t.index,o.open(t)):n=t.group.current,d.updateLayout(),r===!1?r=!0:r!==!0&&r()}function i(e){t.opts.type=e,d.renderMedia(t),d.updateMediaLayout(t),o.slideIn(t,function(){}),d.getMediaColor(t,function(e){function i(){d.light(t.opts.color)}t.opts.color=e,s.light===!1?s.event.on("maskload",i):i()}),s.current.current=t.index}var a,r=!1,n=!1;l.open.call(t),d.enoughThumbs(t.group),s.current&&s.current==t.group&&(n=s.current.current)!==!1&&(s.phase=n&&t.index||n+t.index!=t.group.set.length-1?n<t.index:n>t.index),t.group.main&&d.selectThumb(t),s.zooming&&d.toggleZoom(),s.current?o.slideOut(a=s.current.set[s.current.current],function(){d.detachMedia(a),e()}):e(),d.getMediaType(t,function(t){var e=function(){i(t)};r===!0?e():r=e})},renderLayout:function(e){var a,r=e.main=t('<div class="nch-lb-main"></div>').appendTo(s.b),n=e.opts,o="",u={};e.main.addClass("nch-lb-scheme-"+n.scheme),""==i.backlight&&e.main.addClass("nch-lb-no-backlight"),u.loadicon=t('<div class="nch-lb-media-loading"></div>').appendTo(r),s.canFS&&n.fullscreen&&(o+="nch-lb-can-fs "),n.share&&(o+="nch-lb-can-share "),n.play&&e.set.length>1&&(o+="nch-lb-can-play "),n.zoom&&(o+="nch-lb-can-zoom "),n.info&&(o+="nch-lb-has-info "),s.scrollbar||(o+="nch-lb-no-scrollbar "),r.addClass(o);var c={v:"vertical",h:"horizontal"},h={left:"v",right:"v",top:"h",bottom:"h"},p={v:"width",h:"height"};if(s.asb){var f=u.asb=t('<div class="nch-lb-pngfix"></div>').appendTo(r);d.css3(f).transition("background-color 500ms linear")}n.info&&(e.info=(a=t("#"+n.info)).length?a:t("<div></div>"));var m,g=u.tbar=t('<div class="nch-lb-tbar"></div>').appendTo(r),y=t('<ul class="nch-lb-tbar-controls"></ul>'),v=u.bbar=t('<div class="nch-lb-bar"></div>').appendTo(r),b=u.controls=t('<ul class="nch-lb-controls"></ul>').appendTo(v),j={prev:"left",play:"play",next:"right",title:!1,exit:"exit",fs:"fs",info:"info"},Q={prev:"<",play:"p",next:">",title:"",exit:"x",fs:"f",info:"i"};1==e.set.length&&r.addClass("nch-lb-no-more");for(var w in j)b.append(m='<li class="nch-lb-'+w+'">'+(j[w]?'<div class="nch-lb-icon-'+j[w]+'">'+Q[w]+"</div>":"")+"</li>"),("exit"==w||"title"==w||"info"==w||"fs"==w)&&y.append(m);if(n.thumbs){var x=u.thumbs=t('<ul class="nch-lb-thumbs"></ul>'),k=u.bthumbs=t('<div class="nch-lb-thumbs-bar"></div>').append(x);if(k.addClass("nch-lb-thumbs-"+n.thumbs).css(n.thumbs,0),x.addClass("nch-lb-thumbs-"+c[h[n.thumbs]]).css(p[h[n.thumbs]],n.thumbsize),"bottom"==n.thumbs?v.append(k):"top"==n.thumbs?g.append(k):r.append(k),"v"==h[n.thumbs]){var C={left:"auto",right:"auto"};C["left"==n.thumbs?"right":"left"]=k[p[h[n.thumbs]]](),g.css(C),v.css(C)}}y.appendTo(g);var I,T=u.preview=t('<div class="nch-lb-media-space"></div>').appendTo(r);u.scroller=t('<div class="nch-lb-media-scroller"></div>').appendTo(T).append(I=u.media=t('<div class="nch-lb-media"></div>')),e.css3=d.css3(I);for(var _=u.menu=t('<ul class="nch-lb-photo-menu"></ul>').appendTo(I),S=["zoom","share"],z=["+","h"],w=0;w<S.length;w++)_.append('<li class="nch-lb-'+S[w]+'"><div class="nch-lb-icon-'+S[w]+'">'+z[w]+"</li>");u.info=t('<div class="nch-lb-project"><div class="nch-lb-info-panel"><div class="nch-lb-icon-info">x</div></div></div>').appendTo(r),u.loading=t('<div class="nch-lb-loadbar"></div>').appendTo(r),I.on("mouseover",d.pause).on("mouseout",d.resume),e.blocks=u,n.thumbs&&d.need(e.set,d.getThumbnail,function(){d.renderThumbnails(e)}),u.zoom=t('<div class="nch-lb-zoom-space"><div class="nch-lb-icon-zoom">-</div></div>').appendTo(r),n.autoplay&&(e.playing=!0,e.paused=!0,r.addClass("nch-lb-playing")),t("div.nch-lb-icon-fs",r).each(function(){t(this).click(d.fs.toggle)}),t("li.nch-lb-exit",r).each(function(){t(this).click(l.close)}),t("li.nch-lb-prev",b).click(l.previous),t("li.nch-lb-next",b).click(l.next),t("li.nch-lb-play",b).click(l.play),t("div.nch-lb-icon-info",r).each(function(){t(this).click(d.toggleInfo)}),t("div.nch-lb-icon-zoom",r).hammer().on("tap",d.toggleZoom),r.hammer().on("tap",d.openShare),n.bgclose&&d.backgroundClose(u),u.media.on("tap",function(e){if(s.current){var i=t(e.target);i.is("img")&&i.parent().hasClass("nch-lb-media")&&l.next()}})},backgroundClose:function(t){t.preview.click(function(t){t.target.className.search("nch-lb-media-space")>=0&&l.close()})},fs:{on:!1,request:function(t){return d.fs.on=!0,t.requestFullScreen?t.requestFullScreen():t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?1==t.webkitRequestFullScreen.length?t.webkitRequestFullScreen():t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.mozRequestFullScreen?t.mozRequestFullScreen():d.fs.on=!1},has:function(){var t=d.fs.request(document.documentElement);return 0!=t},exit:function(){var t=document;t.cancelFullScreen?t.cancelFullScreen():t.exitFullscreen?t.exitFullscreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.mozCancelFullScreen&&t.mozCancelFullScreen(),d.fs.on=!1},toggle:function(){var t="nch-lb-onfs",e=s.current.main,i=e.find(".nch-lb-icon-fs");d.fs.on?(e.removeClass(t),d.fs.exit(),i.html("f")):(e.addClass(t),d.fs.request(document.documentElement),i.html("k"))}},loadThumb:function(t,e){var i;this.thumb=i=new Image,i.onload=e,i.src=t},updateLayout:function(i){function a(){s.asb||p.append(s.light[0].$el.height(f[2]+100),s.light[1].$el.height(f[2]+100))}var r=s.current,n=s.wsize=s.w.width(),o=s.hsize=s.w.height();if(r){var u,l=r.blocks,c=l.preview,h=r.opts,p=h.margin,f=[p,p,p,p],p=r.main,m=l.bthumbs,g={top:0,right:1,bottom:2,left:3},y="height",v="width",b=[y,v,y,v];m!==e&&"bottom"!=h.thumbs&&"top"!=h.thumbs&&(f[g[h.thumbs]]+=m[b[g[h.thumbs]]]()),f[0]+=l.tbar.height(),f[2]+=l.bbar.height(),u={top:f[0],left:f[3],width:n-f[1]-f[3],height:o-f[0]-f[2]},l.bbar.width(u.width+2*h.margin),l.tbar.width(u.width+2*h.margin),c.css(t.extend({},u,{left:0,width:n,height:u.height+40})),l.loadicon.css({left:u.left+u.width/2,top:u.top+u.height/2}),r.mspace=u,s.hasCanvas&&(s.light?a():s.event.on("maskload",a)),0!=r.set[r.current].opts.type&&r.set[r.current].target&&d.updateMediaLayout(r.set[r.current]),i!==e&&c.scrollLeft(s.wsize)}},light:function(t,e){if(s.hasCanvas){if(s.asb&&s.current){var i=s.current.blocks.asb.get(0);return i.style.backgroundColor=t,void 0}var a=arguments,r={opacity:1,display:"block"},n={opacity:0},o=s.light[0],u=s.light[1];2==a.length?t.main.append(o.$el,u.canvas):e=t;var t=[0,0,u.width,u.height];u.$el.stop().animate(n,500,function(){d.toColor(u,e),u.$el.css(r),o.$el.hide()}),d.toColor(o,e),o.$el.stop().show().css(n).animate(r,500)}},toColor:function(t,e){var i=t.width,a=t.height,r=t.context;r.clearRect(0,0,i,a),r.fillStyle=e,r.fillRect(0,0,i,a),t.mask()},masks:function(){var e=this,i=(t("div.nch-lb-mask"),t('<canvas class="nch-lb-effcurrent"></canvas>')),a=t('<canvas class="nch-lb-effchange"></canvas>');s.color="#000",s.light=s.asb?[]:[new d.canvasMask(i,e),new d.canvasMask(a,e)],s.event.trigger("maskload")},getImageURL:function(t){var e=/^url\((['"]?)(.*)\1\)$/.exec(t.css("background-image"));return e?e[2]:""},hashChange:function(){var t="";window.setInterval(function(){i.nohashes&&s.hash!=t&&0==(t=s.hash).search("#"+i.hashpath)&&d.route(t.replace("#","")),t!=window.location.hash&&0==(t=s.hash=window.location.hash).search("#"+i.hashpath)&&d.route(t.replace("#",""))},150)},route:function(t){if(r[t]!==e){var i=r[t];d.toMedia(i.call!=e?i():i)}},addRoute:function(t,e){r["nch_"+t]=e},isImage:function(t,a,r){var s=new Image,n=function(){a("image")};s.onerror=r||function(){d.getMediaType(t,a,!0)},s.onload=function(){t.target=this,t.nsize=[this.width,this.height],r===e&&!d.allowedOrigin(this)&&i.cors?d.isImage(t,a,n):a("image")},r!==e&&(s.crossOrigin="anonymous"),s.src=t.opts.href},getMediaType:function(t,i,a){var r=t.opts;if(0!=r.type)return t.target||u[r.type]&&u[r.type].video&&r.videoid===e&&u[r.type].is(t),i(r.type);if(a){for(var a in u)if(u[a].is(t))return i(a)}else d.isImage.apply(this,arguments)},need:function(t,e,i){for(var a=t.length-1,r=0,s=function(){r++==a&&i()},n=0;a>=n;n++)e(t[n],s)},getThumbnail:function(t,i){var a=new Image,r=t.opts,s=r.type,n=function(){i(t)};return t.thumb!==e?i(t):(r.src?(a.onload=n,a.src=r.src,t.thumb=a):u[s]&&u[s].video?(t.opts.videoid===e&&u[s].is(t),u[s].thumb(t,n)):i(t),void 0)},renderThumbnails:function(i){var a,r,s=(i.main,i.opts),n=i.blocks,o=n.thumbs.empty(),u=0,c={bottom:1,top:1,left:0,right:0};o[c[i.opts.thumbs]?"height":"width"](i.opts.thumbsize),window.setTimeout(function(){for(var n in i.set)(a=i.set[n].thumb)!==e&&(r=(a.naturalWidth||a.width)/(a.naturalHeight||a.height),u+=s.thumbsize*(c[i.opts.thumbs]?r:1/r)+8,o.append(t("<li></li>").append(t(i.set[n].thumb).removeAttr("width","height").data("nch-lb-media",i.set[n]).click(l.open))));o[c[i.opts.thumbs]?"width":"height"](u-6)},25),o.hammer({prevent_default:!1}).on("drag",function(){return!0}),o.mousewheel(d.scrollThumbs)},getFX:function(t,e){if(t===!1&&(e.opts.effect=t=e.group.opts.animation),"random"==t){var i=[];for(var a in n)i.push(a);e.opts.effect=e.opts.animation=t=i[Math.round(Math.random()*(i.length-1))]}return n[t]||function(){}},mediaGroup:function(e,a){var s,n,o,u=this;a||(a=d.randomName()),this.main=!1,this.name=s=a,this.opts=n=t.extend({},i,e),this.current=!1,this.set=[],this.playing=!1,this.paused=!1,this.about=!1,this.hasGestures=!1,this.add=function(t,e){var a=new d.mediaItem(t,d.inheritProps(n,e));a.group=u,a.opts.rel=s,a.index=u.set.length,a.opts.href||(a.opts.href=a.opts.src),(o=d.parseColor(a.opts.href+a.opts.src))&&(a.opts.color=o),r[i.hashpath+a.opts.hash]=a,u.set.push(a)}},allowedOrigin:function(e){if(!s.hasCanvas)return!0;var i=s.tcanvas,a=i.getContext("2d"),r=i.width,n=i.height;a.clearRect(0,0,r,n),a.drawImage(e,0,0);try{a.getImageData(0,0,1,1)}catch(o){return t(s.tcanvas).remove(),t(s.tcanvas=document.createElement("canvas")).addClass("nch-lb-testcanvas").appendTo(s.b),!1}return!0},inheritProps:function(t,i){for(var a in t)i[a]!==e&&(t[a]=i[a]);return i},mediaItem:function(e,i){var r;this.main=e,this.opts=r=t.extend({hash:d.getHash(i)},a,i),this.target=!1,this.share=!1,e.data("nch-lb-media",this),e.click(function(t){return t.preventDefault(),l.open.call(this),!1})},keyboard:function(t){var e=t.which,i=s.current;i&&i.opts.keyboard&&(32==e&&i.opts.play&&l.play(),37==e&&l.previous(!0),39==e&&l.next(!0),27==e&&l.close())},setFrom:function(i,a){var r,n=t(),o=new d.mediaGroup(a);for(var u in i)i[u].charAt!==e&&(i[u]={href:i[u]}),r=t('<a href="'+i[u].href+'"></a>'),i[u].src&&r.append('<img src="'+i[u].src+'">'),o.add(r,i[u]),n=n.add(r);return s.all[o.name]=o,n},randomName:function(){return"nch_group_"+Math.round(Math.random()*(new Date).getTime())},getHash:function(t){var a,s,n=t.href?t.href:t.href=t.src,o=0;if(t.hash?1:0,n===e||0==(n+"").length)return o;for(a=0;a<n.length;a++)s=n.charCodeAt(a),o=(o<<5)-o+s,o&=o;if(o=Math.abs(o),r[i.hashpath+o]!==e)for(;r[i.hashpath+o]!==e;)o++;return o},getDataProperties:function(e){e.jquery&&(e=e.get(0));for(var i,a=arguments,r=a[1]?a[1]:[],s={},n=0;n<e.attributes.length;n++){var o=e.attributes[n].name;(r[o]||t.inArray(o,r)>=0||0==o.search("data-"))&&(s[r[o]?r[o]:o.replace("data-","")]=(i=e.getAttribute(o))==parseInt(i)?parseInt(i):i)}return s},canvasMask:function(t,e){if(s.hasCanvas){var i,a,r;this.$el=t,this.canvas=t=t.get(0),this.context=i=t.getContext("2d"),this.mask=e,this.width=a=t.width=e.width,this.height=r=t.height=e.height,i.drawImage(e,0,0),this.maskdata=function(t){for(var e=[],i=0,s=0;r>s;s++)for(var n=0;a>n;n++,i+=4)e.push(t.data[i]);return e}(i.getImageData(0,0,a,r)),i.clearRect(0,0,a,r),this.mask=function(){for(var t=this.maskdata,e=4*t.length,s=0,n=i.getImageData(0,0,a,r);e>s;)n.data[s+3]*=t[s/4]/255,s+=4;i.putImageData(n,0,0)}}},hexToRGB:function(t){var e=t.replace("#",""),i=e.match(/.{1,1}/g);e.length/3<2&&(e=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]),e=e.match(/.{1,2}/g);for(var a=0;3>a;a++)e[a]=parseInt(e[a],16);return e},drawImageOnto:function(t,e,i,a,r,s,n){var o=this,u=arguments;try{t.drawImage(e,i,a,r,s)}catch(l){return window.setTimeout(function(){d.drawImageOnto.apply(o,u)},0),void 0}n()},getMainColor:function(t,e){var i,a,r,n=document.createElement("canvas"),o=n.getContext("2d"),u=0,l=0,c=n.width=200,h=n.height=200,p=[0,0,0],f=d.hexToRGB(s.current.opts.backlight);return n.getContext&&o?(d.drawImageOnto(o,t,0,0,200,200,function(){try{i=o.getImageData(0,0,c,h)}catch(t){return e(f)}for(var s=0;h>s;s++)for(var n=0;c>n;n++)a=(i.data[u]+i.data[u+1]+i.data[u+2])/3,r=Math.abs(a-i.data[u])+Math.abs(a-i.data[u+1])+Math.abs(a-i.data[u+1]),r>l&&(l=r,p=[i.data[u],i.data[u+1],i.data[u+2]]),u+=4;e(p)}),void 0):e(f)}};t.fn.nchlightbox=function(t){return l[t]?l[t].apply(this,Array.prototype.slice.call(arguments,1)):l.init.apply(this,arguments)},t.fn.nchlightbox.defaults=i,t(document).ready(function(){t(".nch-hide-if-javascript").hide(),s.b=t("body"),s.w=t(window).resize(d.updateLayout),s.doc=t(document.documentElement),d.hashChange();var i;s.asb=(i=navigator.userAgent.toLowerCase()).search("android")>0&&i.search("mobile safari")>0&&i.search("linux")>0&&i.search("chrome")<0;var a=document.createElement("canvas"),r=s.root=t('<div class="nch-lb-mask"></div>').appendTo(s.b);(s.hasCanvas=!(!a.getContext||!a.getContext("2d")))?(c=new Image,c.onload=d.masks,c.src=d.getImageURL(r),t(s.tcanvas=document.createElement("canvas")).addClass("nch-lb-testcanvas").appendTo(s.b)):d.masks(),s.canFS=d.fs.has(),d.fs.on=!1,s.w.keyup(d.keyboard);var n=t('<div class="nch-lb-scrollbars"></div>').appendTo(s.b),o=n.get(0).clientWidth,u=n.get(0).offsetWidth;o!==e&&u!==e&&u==o&&(s.scrollbar=!1),n.remove(),t(".nch-lightbox").nchlightbox()})}(jQuery),function(t,e,i,a){function r(t){for(var e=t.split("-"),i=1;i<e.length;i++)e[i]=e[i].substr(0,1).toUpperCase()+e[i].substr(1);return e.join("")}function s(t,e){var s,n=t,o=e||["ms","O","Moz","Webkit","Khtml"],l=(t=r(n)).substr(0,1).toUpperCase()+t.substr(1),c=i.documentElement;if(c.style[t]!==a)return u[n]=n,t;s=(o.join(l+"/")+l).split("/");for(var d in s)if(c.style[s[d]]!==a)return u[n]="-"+o[d].toLowerCase()+"-"+n,s[d];return!1}var n={},o={},u={},l={rotate:"deg",rotateX:"deg",rotateY:"deg",skewX:"deg",skewY:"deg",perspective:"px",scale:"",translateX:"px",translateY:"px",translateZ:"px"};!function(){for(var t=arguments,e=0;e<t.length;e++)o[t[e]]=s(t[e])}("transform","perspective","transition","transform-origin"),n.transform=function(t,e){var i=e===a?t:function(i){return i[t]=e,i}({}),r=[];if(o.transform!==!1){for(var s in i)l[s]!==a&&(i[s]+"").search(l[s])<0&&(i[s]+=l[s]),r.push(s+"("+i[s]+")");this.style[o.transform]=r.join(" ")}},n.transition=function(t){this.style.setProperty===a?this.style[o.transition]=t:this.style.setProperty(u.transition,t)},n.transformOrigin=function(t){this.style.setProperty===a?this.style[o["transform-origin"]]=t:this.style.setProperty(u["transform-origin"],t)},n.perspective=function(t){o.perspective!==!1&&((t+"").search(l.perspective)<0&&(t+=l.perspective),this.style.setProperty===a?this.style[o.perspective]=t:this.style.setProperty(u.perspective,t))},n.animate=function(t,i,r){var s=this,i=i||400,o=[u.transform].join(",")+" "+i/1e3+"s "+"ease-in";n.transition.call(this,o),n.transform.call(this,t),e.setTimeout(function(){n.transition.call(s,"none"),r!==a&&r()},i)},t.fn.nchlightbox("access","css3",function(t){return new function(t){var e=this;this.el=t.jquery===a?t:(this.$el=t).get(0);for(var i in n)this[i]=function(t){return function(){n[t].apply(e.el,arguments)}}(i)}(t)})}(jQuery,window,document),function(t,e){function i(i,a,r){return function(s,n,o,u){if(u!==e)return 1==r?e:r*u;var l=a(n,Math.abs(n)),c=[l[0]];s.transformOrigin(l[2]||d),o&&c.push(i.fxspeed),l[0]!==e&&s[o?"animate":"transform"].apply({},c),l[1]!==e&&(c[0]=l[1],t.fn[o?"animate":"css"].apply(s.$el.stop(),c))}}var a="perspective",r="skewX",s="rotate",n="rotateX",o="rotateY",u="translateY",l="translateZ",c="opacity",d="50% 50%",h=t.fn.nchlightbox.defaults,p="scale";
t.fn.nchlightbox("fx",{swipe:function(){},fade:i(h,function(t,i){var a={};return a[c]=1-i,[e,a]},1),scale:i(h,function(t,e){var i={};return i[p]=1-.6*e,[i]},1),slideUp:i(h,function(t){var e={};return e[u]=900*t,[e]},0),slideDown:i(h,function(t){var e={};return e[u]=-900*t,[e]},0),flip:i(h,function(t){var e={};return e[a]=1e3,e[o]=90*t,[e]},0),skew:i(h,function(t){var e={};return e[a]=1e3,e[r]=30*t,[e]},1),bounceDown:i(h,function(t,e){var i={};return i[a]=100,i[u]=1e3*e,[i]},1),bounceUp:i(h,function(t,e){var i={};return i[a]=100,i[u]=-1e3*e,[i]},1),hangLeft:i(h,function(t){var i={};return i[s]=-179*t,[i,e,"0% 0%"]},0),hangRight:i(h,function(t){var i={};return i[s]=-179*t,[i,e,"100% 0%"]},0),zoomIn:i(h,function(t,e){var i={},r={};return i[a]=800,i[l]=800*e,i[s]=45*t,r[c]=1-e,[i,r]},0),breakIn:i(h,function(t){var e={};return e[s]=45*t,[e]},1),rotateIn:i(h,function(t,e){var i={};return i[a]=1e3,i[o]=90*t,i[p]=1-.3*e,[i]},1),rotateOut:i(h,function(t,e){var i={};return i[a]=1e3,i[o]=-90*t,i[p]=1-.3*e,[i]},1),cicleDown:i(h,function(t,e){var i={},r={};return i[a]=1200,i[n]=-90*t,i[u]=200*e,r[c]=1-e,[i,r,"50% 100%"]},0),cicleUp:i(h,function(t,e){var i={},r={};return i[a]=1200,i[n]=-90*t,i[u]=-200*e,r[c]=1-e,[i,r,"50% 1%"]},0),throwIn:i(h,function(t,e){var i={},r={};return i[a]=800,i[p]=1-.6*e,i[s]=180*t,r[c]=1-e,[i,r]},.3),fall:i(h,function(t,e){var i={},r={};return i[a]=1800,i[n]=-90*e,i[s]=90*t,i[l]=-400*t,r[c]=Math.pow(1-e,.25),[i,r,d]},0),jump:i(h,function(t,e){var i={};return i[a]=1500,i[p]=1-.999*e,i[u]=300*e,i[n]=100*e,i[l]=1e3*e,[i]},0)})}(jQuery),function(t){function e(t,e){for(var i="",a=!1,r="",s=0;s<t.length;s++)a?"}"==t.charAt(s)?(e[r]&&(i+=e[r]),a=!1,r=""):r+=t.charAt(s):"{"==t.charAt(s)?a=!0:i+=t.charAt(s);return i}function i(t){return"undefined"==typeof t.has.charAt?t.has():"undefined"!=typeof window[t.has]?!0:!1}function a(t){var e=document.createElement("script");e.async=!0,e.id=t.id,e.src=t.src,s.append(e)}function r(t,a,r){for(var s,a=a.split(","),o="",u=[],l=0;l<a.length;l++)(u[l]=i(s=n[a[l]]))&&(o+=e(s.create,r));t.append(o);for(var l in a)u[l]&&n[a[l]].parse(n[a[l]].api(),t.get(0))}var s,n={fb:{has:"FB",api:function(){return FB},parse:function(t,e){t.XFBML.parse(e)},id:"facebook-jssdk",src:"//connect.facebook.net/en_US/all.js",create:'<iframe class="fb-like" src="//www.facebook.com/plugins/like.php?layout=standard&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=20&amp;href={url}" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:20px;" allowTransparency="true"></iframe>'},tw:{has:"twttr",api:function(){return twttr},parse:function(t,e){t.widgets.load(e)},id:"twitter-wjs",src:"//platform.twitter.com/widgets.js",create:'<a href="https://twitter.com/share" class="twitter-share-button" data-url="{url}" data-text="{title}" data-count="none">Tweet</a>'},gp:{has:function(){return"undefined"==typeof gapi||"undefined"==typeof gapi.plusone?!1:!0},api:function(){return gapi.plusone},parse:function(t,e){t.go(e)},id:"",src:"//apis.google.com/js/plusone.js",create:'<div class="g-plusone" data-size="medium" data-annotation="none" data-href="{url}"></div>'},pin:{has:function(){for(var t in window)if(0==t.search("PIN_"))return!0;return!1},api:function(){for(var t in window)if(0==t.search("PIN_")&&window[t].f)return window[t]},parse:function(e,i){for(var a,r=t(i).is("a")?[i]:i.getElementsByTagName("a"),s=e.f.render,n=0;n<r.length;n++)"undefined"!=typeof(a=t(r[n]).attr("data-pin-do"))&&s[a](r[n])},id:"",src:"//assets.pinterest.com/js/pinit.js",create:'<a href="//pinterest.com/pin/create/button/?url={url}&media={media}&description={title}" data-pin-do="buttonPin" data-pin-config="none"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png" /></a>'}};t(window).load(function(){var e;s=t("body");for(var o in n)e=n[o],i(e)||a(e);t.fn.nchlightbox("access","shareButtons",r)})}(jQuery),function(t,e,i){var a={grid:function(e,i){this.name="",this.set=e,this.opts=t.extend({},t.fn.nchgrid.defaults,i),this.images=[],this.items=[],this.cols=[],this.width=0,this.columns=0,this.filters=[],i.target||(this.opts.target=t(e.parent()))},column:function(){this.images=[],this.height=0,this.width=0,this.aspect=0,this.less=!1,this.addImage=function(t){this.images.push(t),this.aspect+=t.aspect}},getColumns:function(t,e){for(var i=0;e[i]<t;)i++;return i==e.length?i:i+1},resolveDeltaHeight:function(t,e,i,a){return(t+e*a)/(i+a)},spreadImages:function(t,e){var a=t.images,r=a.length;if(t.opts.order)for(var s=0;r>s;s++)e[s%t.columns].addImage(a[s]);else{for(var n,o=a.length,u=0,l=t.columns,c=[],s=0;l>s;s++)c.push({index:c.length,aspect:0});for(;o>u;){n=[];for(var s=0;l>s;s++)a[u+s]!=i&&n.push({aspect:1/a[u+s].aspect,index:u+s});n.sort(function(t,e){return t.aspect>e.aspect}),c.sort(function(t,e){return t.aspect<e.aspect});for(var s=0;s<n.length;s++)e[c[s].index].addImage(a[n[s].index]),c[s].aspect+=n[s].aspect;u+=l}}},renderGrid:function(e){var i=function(){a.updateGrid(e)};t(window).resize(i),i()},updateGrid:function(e){var i=e.opts,r=(e.set,e.images),s=i.target,n=e.cols,o=i.target.width();if(e.width!=o){if(e.columns=a.getColumns(e.width=o,i.grid),e.columns!=n.length){n=[];for(var u=0;u<e.columns;u++)n[u]=new a.column;a.spreadImages(e,n)}for(var l=e.width-(n.length-1)*i.margin,c=Math.floor(r.length/e.columns),d=0,h=0,u=0;u<e.columns;u++)(n[u].less=n[u].images.length==c)?d+=1/n[u].aspect:h+=1/n[u].aspect;for(var p,f,m,g=a.resolveDeltaHeight(l,i.margin,d,h),y=0,v=0,u=0;u<n.length;u++){f=n[u],all=f.images,p=1/f.aspect*(g-(f.less?0:i.margin)),v=0;for(var b=0;b<all.length;b++)m=t(e.items[all[b].index]).css({position:"absolute",left:y,top:v,width:p,height:p*all[b].aspect,display:"block"}).addClass("nchgrid-tile"),v+=p*all[b].aspect+i.margin;y+=p+i.margin}s.height(v-i.margin),"static"==s.css("position")&&s.css("position","relative")}},triggerClick:function(e){e.preventDefault(),t(e.target).is("img")||t(this).find("img").click()},loadTiles:function(){function e(e,s,n){var o,u;i.images[e]={width:s,height:n,aspect:n/s,src:i.set[e].src,index:e,caption:u=i.set[e].title},i.items[e]=(o=t('<div class="nchgrid-item"></div>').insertAfter(i.set[e]).append(i.set[e])).get(0),i.opts.captions&&(u+"").length?o.append('<div class="nchgrid-caption"></div><div class="nchgrid-caption-text">'+u+"</div>").click(a.triggerClick):o.append('<div class="nchgrid-caption"></div>').click(a.triggerClick),r++==i.set.length-1&&a.renderGrid(i)}var i=this,r=0;this.set.each(function(t,i){var a=new Image;a.onload=function(){e(t,this.width,this.height),i.style.display="block"},a.src=this.src,i.style.display="none"})}},r={init:function(e){var i=this;if(!this.length){var r,s=arguments,n=e,o=[];e=t.extend({},t.fn.nchgrid.defaults,2==s.length?s[1]:{});for(var u=0;u<n.length;u++)r=new Image,r.src=n[u],o.push(r);i=this.add(o).appendTo(e.target)}return a.loadTiles.call(new a.grid(i,t.extend({},t.fn.nchgrid.defaults,e||{}))),i}};t.fn.nchgrid=function(t){return r[t]?r[t].apply(this,Array.prototype.slice.call(arguments,1)):r.init.apply(this,arguments)},t.fn.nchgrid.defaults={margin:4,grid:[240,480,720,960,1240],captions:!1,order:!1,target:!1}}(jQuery,window),function(t,e,i,a){function r(t){2==(t.gesture.srcEvent.type+"").split("touch").length&&(u=!0),l.off("touch",r)}function s(e,i,r){function s(){v.cwidth=v.container.width(),v.cheight=v.container.height()}function n(t){return t=t===a?1:t,{e:[t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1]}}function l(t){return t.e.join(", ")}function c(t){var e=v.width*t-v.cwidth,i=v.height*t-v.cheight;_=-Math.abs(0>e?0:e),S=-Math.abs(0>i?0:i)}var d,h,p,f=1,m=0,g=0,y=!1,v=this;this._el=o(e),this.$el=e.css({display:"block"}),this.container=p=t("<div></div>").insertAfter(e).append(e),this._container=p.hammer({prevent_default:!0}),this.width=e.get(0).width||e.width(),this.height=e.get(0).height||e.height(),this.scale=1,this.centerX=.5,this.centerY=.5,this.translateX=0,this.translateY=0,this.transform=v.transform=n(),this._el.transformOrigin("0 0"),this.container.css({width:i||this.width,height:r||this.height,overflow:u?"hidden":"auto"});var b,j,Q,w,x,k,C,I,m=0,g=0,T=0,_=0,S=0,z=0,$=0,M=0,D=!1,F=!1;s(),this.transformStart=function(t){F&&(F=!1,v.dragEnd(t)),s(),D=!0,b=t.gesture.center.pageX,j=t.gesture.center.pageY,Q=p.scrollLeft(),w=p.scrollTop(),x=p.offset(),k=x.left,C=x.top,v.centerX=d=(b-k-m-$)/v.width/v.scale,d=0>d?0:d>1?1:d,v.centerY=h=(j-C-g-M)/v.height/v.scale,h=0>h?0:h>1?1:h},this.drag=function(t){if(!D){y=t.gesture,$=y.deltaX+m+T,M=y.deltaY+g+z,c(f);var e=n(f);e.e[12]=$=0>$?$>_?$:_:0,e.e[13]=M=0>M?M>S?M:S:0,v._el.transform("matrix3d",l(I=e))}},this.pinch=function(t){D=!0,y=t.gesture,f=v.scale*y.scale,1>f&&(f=1),f>4&&(f=4),c(f),T=(v.scale-f)*v.width*v.centerX+m+$,z=(v.scale-f)*v.height*v.centerY+g+$;var e=n(f);e.e[12]=T=0>T?T>_?T:_:0,e.e[13]=z=0>z?z>S?z:S:0,v._el.transform("matrix3d",l(I=e))},this.transformEnd=function(){v.scale=f,v.transform=I,D=!0,m=T,g=z,$=M=T=z=0},this.dragEnd=function(){return F=!1,D?(D=!1,void 0):(v.transform=I,m=$,g=M,T=z=$=M=0,void 0)},this.dragStart=function(){s(),D||(D=!1,F=!0)},u&&this._container.on("transformstart",this.transformStart).on("transform",this.pinch).on("transformend",this.transformEnd).on("dragstart",this.dragStart).on("drag",this.drag).on("dragend",this.dragEnd)}var n=t.fn.nchlightbox("access"),o=n.css3,u=!1,l=t(e).hammer();l.on("touch",r),t.fn.nchlightbox("access","pinch",function(e,i){var r;return t(this).each(function(n,o){var u;o=t(o),o.data("nch-pinchzoom",u=new s(o,e,i)),r===a?r=t(u.container):r.add(u.container)}),r})}(jQuery,window,document);